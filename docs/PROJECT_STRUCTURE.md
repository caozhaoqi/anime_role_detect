# 项目结构说明

## 1. 项目概览

本项目是一个动漫角色检测系统，用于识别和分类不同动漫和游戏中的角色。项目采用深度学习技术，通过数据采集、处理、模型训练和部署的完整流程，实现角色的自动识别。

## 2. 目录结构

```
anime_role_detect/
├── config/                # 配置文件目录
│   └── config.py          # 主配置文件
├── data/                  # 数据存储目录
│   ├── train/             # 训练数据
│   ├── val/               # 验证数据
│   └── test/              # 测试数据
├── docs/                  # 文档目录
│   ├── PROJECT_STRUCTURE.md  # 项目结构说明
│   └── ...                # 其他文档
├── logs/                  # 日志目录
├── models/                # 模型存储目录
│   ├── checkpoints/       # 模型检查点
│   └── onnx/              # ONNX格式模型
├── scripts/               # 脚本目录
│   └── ...                # 各种脚本文件
├── src/                   # 源代码目录
│   ├── data_collection/   # 数据采集模块
│   ├── data_processing/   # 数据处理模块
│   ├── model_training/    # 模型训练模块
│   └── utils/             # 工具模块
├── tests/                 # 测试目录
├── auto_spider_img/       # 自动爬虫相关目录
│   ├── characters/        # 角色列表
│   └── ...                # 其他爬虫相关文件
├── README.md              # 项目说明
└── README.zh.md           # 中文项目说明
```

## 3. 模块说明

### 3.1 配置模块 (config/)

- **config.py**: 主配置文件，集中管理项目的所有配置参数，包括路径、阈值、训练参数等。

### 3.2 数据模块 (data/)

- **train/**: 训练数据集，按角色分类存储图像。
- **val/**: 验证数据集，用于模型评估。
- **test/**: 测试数据集，用于最终模型测试。

### 3.3 文档模块 (docs/)

- **PROJECT_STRUCTURE.md**: 项目结构说明文档。
- 其他文档文件，如API文档、使用说明等。

### 3.4 模型模块 (models/)

- **checkpoints/**: 模型训练过程中的检查点文件。
- **onnx/**: 转换为ONNX格式的模型，用于部署。

### 3.5 脚本模块 (scripts/)

各种辅助脚本，用于数据处理、模型评估等任务。

### 3.6 源代码模块 (src/)

#### 3.6.1 数据采集模块 (data_collection/)

- **series_based_collector.py**: 基于系列的角色图像采集器。
- **keyword_based_collector.py**: 基于关键词的图像采集器。
- **fetch_real_characters.py**: 从可靠来源获取真实角色名称。
- **fetch_wiki_characters.py**: 从维基百科获取角色信息。
- 其他数据采集相关脚本。

#### 3.6.2 数据处理模块 (data_processing/)

- **data_quality_controller.py**: 数据质量控制器，确保采集的图像符合质量标准。
- **data_augmentation.py**: 数据增强工具，扩充训练数据集。
- **dataset_splitter.py**: 数据集分割工具，将数据分为训练、验证和测试集。
- 其他数据处理相关脚本。

#### 3.6.3 模型训练模块 (model_training/)

- **train_model.py**: 基础模型训练脚本。
- **train_improved_model.py**: 改进的模型训练脚本。
- **hyperparameter_tuning.py**: 超参数调优脚本。
- **model_ensemble.py**: 模型集成脚本。
- **convert_to_onnx.py**: 模型格式转换脚本。
- 其他模型训练相关脚本。

#### 3.6.4 工具模块 (utils/)

- **config_utils.py**: 配置工具，方便其他模块使用配置。
- 其他工具函数和类。

### 3.7 测试模块 (tests/)

单元测试和集成测试文件。

### 3.8 自动爬虫模块 (auto_spider_img/)

- **characters/**: 角色列表目录，存储各个系列的角色名称。
- **anime_set.txt**: 系列配置文件，定义需要采集的动漫和游戏系列。
- 其他爬虫相关文件。

## 4. 核心功能

### 4.1 数据采集

- 基于系列的角色图像采集
- 基于关键词的图像搜索
- 从多个来源获取角色信息
- 图像质量控制和过滤

### 4.2 数据处理

- 数据质量评估
- 数据增强
- 数据集分割
- 数据格式转换

### 4.3 模型训练

- 基础模型训练
- 模型优化和调优
- 模型集成
- 模型格式转换

### 4.4 模型推理

- 角色识别
- 置信度评估
- 结果输出

## 5. 使用流程

1. **配置项目**: 修改config.py中的配置参数。
2. **数据采集**: 运行数据采集脚本，获取角色图像。
3. **数据处理**: 运行数据处理脚本，准备训练数据。
4. **模型训练**: 运行模型训练脚本，训练角色识别模型。
5. **模型评估**: 运行模型评估脚本，评估模型性能。
6. **模型部署**: 转换模型为ONNX格式，部署到生产环境。

## 6. 技术栈

- **编程语言**: Python 3.9+
- **深度学习框架**: PyTorch
- **图像处理**: OpenCV, PIL
- **数据存储**: 本地文件系统
- **模型格式**: PyTorch, ONNX

## 7. 扩展说明

### 7.1 添加新角色

1. 在auto_spider_img/characters/目录下创建新的角色列表文件。
2. 在anime_set.txt中添加新的系列。
3. 运行数据采集脚本获取新角色的图像。

### 7.2 扩展模型

1. 在src/model_training/目录下创建新的模型训练脚本。
2. 修改配置文件中的模型参数。
3. 运行新的模型训练脚本。

### 7.3 部署到新环境

1. 转换模型为ONNX格式。
2. 根据目标环境的要求，调整部署代码。
3. 部署模型到目标环境。

## 8. 维护说明

- **数据更新**: 定期更新角色列表和图像数据。
- **模型更新**: 定期重新训练模型，以适应新数据。
- **配置管理**: 集中管理配置参数，避免硬编码。
- **代码规范**: 遵循Python代码规范，保持代码可读性。

## 9. 总结

本项目采用模块化设计，结构清晰，功能完整。通过合理的目录组织和模块划分，提高了代码的可维护性和可扩展性。同时，通过集中的配置管理，使得项目参数的调整更加方便。

项目的核心价值在于实现了从数据采集到模型部署的完整流程，为动漫角色的自动识别提供了可行的解决方案。