<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§’è‰²æ£€æµ‹å·¥ä½œæµ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        h2 {
            color: #555;
            margin-top: 30px;
        }
        .workflow-form {
            margin: 30px 0;
            padding: 20px;
            border: 2px dashed #ccc;
            border-radius: 10px;
        }
        .form-group {
            margin: 20px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        input[type="number"] {
            width: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            resize: vertical;
            min-height: 100px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        .flash-message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background-color: #f8d7da;
            color: #721c24;
        }
        .info-box {
            background-color: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background-color: #f9f9f9;
            border-top: 1px solid #ddd;
            border-radius: 0 0 10px 10px;
        }
        a {
            color: #2196F3;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .loading {
            display: none;
            text-align: center;
            margin: 30px 0;
        }
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .character-item {
            display: flex;
            margin: 10px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
        .character-item input {
            margin: 0 10px;
        }
        .add-character {
            margin: 10px 0;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
            text-align: center;
        }
        .add-character button {
            background-color: #2196F3;
        }
        .add-character button:hover {
            background-color: #0b7dda;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ è§’è‰²æ£€æµ‹å·¥ä½œæµ</h1>
        <p>è¾“å…¥è§’è‰²ä¿¡æ¯ï¼Œè‡ªåŠ¨é‡‡é›†æ•°æ®ã€è®­ç»ƒæ¨¡å‹å¹¶æ£€æµ‹è§’è‰²</p>
        
        <!-- é”™è¯¯æ¶ˆæ¯ -->
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                    <div class="flash-message">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <!-- å·¥ä½œæµè¡¨å• -->
        <div class="workflow-form">
            <h2>ğŸ“‹ å·¥ä½œæµé…ç½®</h2>
            <form method="post" onsubmit="showLoading()">
                <!-- è§’è‰²ä¿¡æ¯ -->
                <div class="form-group">
                    <label for="characters">è§’è‰²ä¿¡æ¯ (JSONæ ¼å¼):</label>
                    <textarea id="characters" name="characters" required>[
  {"name": "åƒæ—©çˆ±éŸ³", "series": "bangdream_mygo"},
  {"name": "é«˜æ¾ç¯", "series": "bangdream_mygo"},
  {"name": "é•¿å´ç´ ä¸–", "series": "bangdream_mygo"},
  {"name": "ç‰äº•ç¥¥å­", "series": "bangdream_mygo"}
]</textarea>
                    <small>æ ¼å¼: [{"name": "è§’è‰²å", "series": "ç³»åˆ—å"}]</small>
                </div>
                
                <!-- æµ‹è¯•å›¾åƒ -->
                <div class="form-group">
                    <label for="test_image">æµ‹è¯•å›¾åƒè·¯å¾„:</label>
                    <input type="text" id="test_image" name="test_image" value="tests/img/å¾®ä¿¡å›¾ç‰‡_20260204115846_481_347.jpg" required>
                    <small>è¯·è¾“å…¥æµ‹è¯•å›¾åƒçš„ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„</small>
                </div>
                
                <!-- é‡‡é›†å‚æ•° -->
                <div class="form-group">
                    <label for="max_images">æ¯ä¸ªè§’è‰²çš„æœ€å¤§å›¾ç‰‡æ•°é‡:</label>
                    <input type="number" id="max_images" name="max_images" value="50" min="1" max="200">
                </div>
                
                <!-- è®­ç»ƒå‚æ•° -->
                <div class="form-group">
                    <label>è®­ç»ƒå‚æ•°:</label>
                    <div style="margin-left: 20px;">
                        <p>æ‰¹é‡å¤§å°: <input type="number" name="batch_size" value="16" min="1" max="64" style="width: 80px;"></p>
                        <p>è®­ç»ƒè½®æ•°: <input type="number" name="num_epochs" value="50" min="1" max="200" style="width: 80px;"></p>
                        <p>å­¦ä¹ ç‡: <input type="text" name="learning_rate" value="5e-5" style="width: 100px;"></p>
                        <p>æ•°æ®åŠ è½½çº¿ç¨‹æ•°: <input type="number" name="num_workers" value="4" min="1" max="16" style="width: 80px;"></p>
                    </div>
                </div>
                
                <!-- æ£€æµ‹å‚æ•° -->
                <div class="form-group">
                    <label>æ£€æµ‹å‚æ•°:</label>
                    <div style="margin-left: 20px;">
                        <p>æ£€æµ‹é˜ˆå€¼: <input type="number" name="threshold" value="0.5" min="0" max="1" step="0.1" style="width: 80px;"></p>
                        <p>æ£€æµ‹å¤šä¸ªè§’è‰²: <input type="checkbox" name="multiple" value="true"></p>
                        <p>ç½‘æ ¼å¤§å°: <input type="number" name="grid_size" value="3" min="2" max="10" style="width: 80px;"></p>
                    </div>
                </div>
                
                <!-- æäº¤æŒ‰é’® -->
                <div class="form-group">
                    <button type="submit">ğŸš€ å¯åŠ¨å·¥ä½œæµ</button>
                </div>
            </form>
        </div>
        
        <!-- åŠ è½½åŠ¨ç”» -->
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p style="margin-top: 15px; color: #555;">å·¥ä½œæµå¯åŠ¨ä¸­ï¼Œè¯·ç¨å€™...</p>
            <p style="margin-top: 10px; color: #888; font-size: 14px;">æ­¤è¿‡ç¨‹å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ŒåŒ…æ‹¬æ•°æ®é‡‡é›†ã€æ¨¡å‹è®­ç»ƒç­‰æ­¥éª¤</p>
        </div>
        
        <script>
            function showLoading() {
                document.getElementById('loading').style.display = 'block';
                // ç¦ç”¨æäº¤æŒ‰é’®
                document.querySelector('button[type="submit"]').disabled = true;
            }
        </script>
        
        <!-- ç³»ç»Ÿä¿¡æ¯ -->
        <div class="info-box">
            <h3>â„¹ï¸ å·¥ä½œæµè¯´æ˜</h3>
            <p>â€¢ <strong>æ•°æ®é‡‡é›†</strong>: æ ¹æ®è¾“å…¥çš„è§’è‰²ä¿¡æ¯ï¼Œè‡ªåŠ¨ä»ç½‘ç»œä¸Šé‡‡é›†è§’è‰²å›¾ç‰‡</p>
            <p>â€¢ <strong>æ•°æ®é›†åˆ†å‰²</strong>: å°†é‡‡é›†åˆ°çš„æ•°æ®åˆ†å‰²ä¸ºè®­ç»ƒé›†å’ŒéªŒè¯é›†</p>
            <p>â€¢ <strong>æ¨¡å‹è®­ç»ƒ</strong>: ä½¿ç”¨åˆ†å‰²åçš„æ•°æ®è®­ç»ƒè§’è‰²åˆ†ç±»æ¨¡å‹</p>
            <p>â€¢ <strong>è§’è‰²æ£€æµ‹</strong>: ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹æ£€æµ‹æµ‹è¯•å›¾ç‰‡ä¸­çš„è§’è‰²</p>
            <p>â€¢ <strong>æ³¨æ„äº‹é¡¹</strong>: å·¥ä½œæµå¯èƒ½éœ€è¦æ•°å°æ—¶å®Œæˆï¼Œå…·ä½“æ—¶é—´å–å†³äºè§’è‰²æ•°é‡å’Œç½‘ç»œé€Ÿåº¦</p>
        </div>
        
        <!-- å¿«é€Ÿé“¾æ¥ -->
        <div class="footer">
            <p><a href="/">è¿”å›é¦–é¡µ</a> | <a href="/about">å…³äºç³»ç»Ÿ</a></p>
            <p>Â© 2026 è§’è‰²åˆ†ç±»ç³»ç»Ÿ</p>
        </div>
    </div>
</body>
</html>